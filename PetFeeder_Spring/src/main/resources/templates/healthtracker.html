<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Health Tracker Predictions</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"/>
</head>
<body>
<header th:insert="~{navbar.html}"></header>

<main class="container mt-5">
    <h1 class="text-center mb-4">Health Tracker Predictions</h1>

    <div class="text-center">
        <h2>Visualization of Predictions</h2>
        <div id="graph-container" class="mt-4">
            <!-- Add an <img> element for the graph -->
            <img id="graph" class="img-fluid mt-3" alt="Graph will appear here">
        </div>

        <script>
            document.addEventListener("DOMContentLoaded", async () => {
                try {
                    const response = await fetch("http://127.0.0.1:5000/api/visualize", {
                        method: "POST",
                        headers: {"Content-Type": "application/json"},
                        body: JSON.stringify([
                            {"Age (weeks)": 10, "Predicted Weight (grams)": 120.5, "Predicted Food Intake (grams)": 15.2},
                            {"Age (weeks)": 20, "Predicted Weight (grams)": 140.3, "Predicted Food Intake (grams)": 17.8},
                            {"Age (weeks)": 30, "Predicted Weight (grams)": 160.0, "Predicted Food Intake (grams)": 20.1}
                        ])
                    });

                    if (!response.ok) throw new Error("Failed to fetch graph");

                    const blob = await response.blob();
                    const url = URL.createObjectURL(blob);

                    // Display the image
                    const graphImage = document.getElementById("graph");
                    graphImage.src = url;
                    graphImage.alt = "Prediction Graph";
                } catch (error) {
                    console.error("Error fetching graph:", error);
                    document.getElementById("graph-container").textContent = "Failed to load graph.";
                }
            });
        </script>
    </div>
</main>

<footer th:insert="~{footer.html}" class="mt-5"></footer>


</body>
</html>
